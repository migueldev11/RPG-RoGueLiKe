<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Rogue-like ASCII Dungeon</title>
<style>
  body {
    font-family: monospace;
    background: #111;
    color: #eee;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    user-select: none;
    touch-action: manipulation;
  }
  #game-container {
    white-space: pre;
    font-size: 14px;
    line-height: 14px;
    background: #222;
    padding: 10px;
    width: max-content;
    border: 3px solid #555;
    margin-bottom: 10px;
  }
  #hotbar {
    display: flex;
    justify-content: space-around;
    width: 320px;
    background: #333;
    padding: 6px 0;
    font-size: 14px;
    border-top: 2px solid #555;
  }
  #controls {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 10px;
  }
  #controls button {
    background: #555;
    border: none;
    color: #eee;
    font-size: 22px;
    width: 50px;
    height: 50px;
    border-radius: 10px;
    user-select: none;
  }
  #controls button:active {
    background: #888;
  }
  #msg {
    width: 320px;
    min-height: 40px;
    background: #111;
    color: #afa;
    font-size: 14px;
    padding: 5px;
    border: 2px solid #555;
    margin-bottom: 10px;
    overflow-wrap: break-word;
  }
</style>
</head>
<body>

<h1>Rogue-like ASCII Dungeon</h1>

<div id="game-container"></div>

<div id="hotbar">
  <div>Vida: <span id="hp">100</span></div>
  <div>Level: <span id="level">1</span></div>
  <div>Tempo: <span id="time">0s</span></div>
  <div>Itens: <span id="items">Nenhum</span></div>
</div>

<div id="msg"></div>

<div id="controls">
  <button id="up">▲</button>
</div>
<div id="controls">
  <button id="left">◄</button>
  <button id="down">▼</button>
  <button id="right">►</button>
</div>

<script>
(() => {
  const gameContainer = document.getElementById('game-container');
  const hpElem = document.getElementById('hp');
  const levelElem = document.getElementById('level');
  const timeElem = document.getElementById('time');
  const itemsElem = document.getElementById('items');
  const msgElem = document.getElementById('msg');

  const MAP_WIDTH = 40;
  const MAP_HEIGHT = 20;

  // Mapa será matriz 2D de chars: '#' parede, ' ' chão, '@' player, 'Z' zumbi etc

  let map = [];
  let player = {
    x: 0,
    y: 0,
    hp: 100,
    level: 1,
    items: []
  };
  let gameTime = 0;

  // Função que cria um mapa procedural simples com salas e corredores
  function generateDungeon() {
    // Inicializa mapa todo com paredes
    map = [];
    for (let y = 0; y < MAP_HEIGHT; y++) {
      let row = [];
      for (let x = 0; x < MAP_WIDTH; x++) {
        row.push('#');
      }
      map.push(row);
    }

    // Cria 4 a 6 salas retangulares aleatórias
    const rooms = [];
    const roomCount = 4 + Math.floor(Math.random() * 3);

    for (let i = 0; i < roomCount; i++) {
      const w = 5 + Math.floor(Math.random() * 6);
      const h = 4 + Math.floor(Math.random() * 4);
      const x = Math.floor(Math.random() * (MAP_WIDTH - w - 1));
      const y = Math.floor(Math.random() * (MAP_HEIGHT - h - 1));

      // Abre espaço para sala
      for (let ry = y; ry < y + h; ry++) {
        for (let rx = x; rx < x + w; rx++) {
          map[ry][rx] = ' ';
        }
      }
      rooms.push({x, y, w, h});
    }

    // Liga as salas com corredores (horizontal + vertical)
    for (let i = 1; i < rooms.length; i++) {
      const prev = rooms[i - 1];
      const curr = rooms[i];
      // Centro das salas
      const prevX = Math.floor(prev.x + prev.w/2);
      const prevY = Math.floor(prev.y + prev.h/2);
      const currX = Math.floor(curr.x + curr.w/2);
      const currY = Math.floor(curr.y + curr.h/2);

      // Corredor horizontal
      for (let cx = Math.min(prevX, currX); cx <= Math.max(prevX, currX); cx++) {
        map[prevY][cx] = ' ';
      }
      // Corredor vertical
      for (let cy = Math.min(prevY, currY); cy <= Math.max(prevY, currY); cy++) {
        map[cy][currX] = ' ';
      }
    }

    // Coloca jogador na sala 0, no centro
    const startRoom = rooms[0];
    player.x = Math.floor(startRoom.x + startRoom.w / 2);
    player.y = Math.floor(startRoom.y + startRoom.h / 2);
  }

  // Desenha o mapa no div em texto ASCII
  function draw() {
    let output = '';
    for (let y = 0; y < MAP_HEIGHT; y++) {
      for (let x = 0; x < MAP_WIDTH; x++) {
        if (x === player.x && y === player.y) output += '@';
        else output += map[y][x];
      }
      output += '\n';
    }
    gameContainer.textContent = output;
  }

  // Atualiza hotbar
  function updateHotbar() {
    hpElem.textContent = player.hp;
    levelElem.textContent = player.level;
    timeElem.textContent = gameTime + 's';
    itemsElem.textContent = player.items.length > 0 ? player.items.join(', ') : 'Nenhum';
  }

  // Checa se pode andar (não andar em parede)
  function canMoveTo(x, y) {
    if (x < 0 || x >= MAP_WIDTH || y < 0 || y >= MAP_HEIGHT) return false;
    if (map[y][x] === '#') return false;
    return true;
  }

  // Movimenta o jogador
  function movePlayer(dx, dy) {
    const nx = player.x + dx;
    const ny = player.y + dy;
    if (canMoveTo(nx, ny)) {
      player.x = nx;
      player.y = ny;
      addMessage(`Você se moveu para (${nx},${ny})`);
    } else {
      addMessage('Não pode andar aí!');
    }
    draw();
    updateHotbar();
  }

  // Exibe mensagem
  function addMessage(text) {
    msgElem.textContent = text;
  }

  // Controles botões
  document.getElementById('up').onclick = () => movePlayer(0, -1);
  document.getElementById('down').onclick = () => movePlayer(0, 1);
  document.getElementById('left').onclick = () => movePlayer(-1, 0);
  document.getElementById('right').onclick = () => movePlayer(1, 0);

  // Teclado para desktop
  window.addEventListener('keydown', e => {
    switch (e.key) {
      case 'ArrowUp': movePlayer(0, -1); break;
      case 'ArrowDown': movePlayer(0, 1); break;
      case 'ArrowLeft': movePlayer(-1, 0); break;
      case 'ArrowRight': movePlayer(1, 0); break;
    }
  });

  // Inicia jogo
  generateDungeon();
  draw();
  updateHotbar();

  // Tempo
  setInterval(() => {
    gameTime++;
    updateHotbar();
  }, 1000);

})();
</script>

</body>
</html>